<!DOCTYPE html>
<html>

<head>
  <meta charset="UTF-8">
  <title>Continuous Spinner</title>
  <style>
    body {
      background: #111;
      color: #eee;
      display: flex;
      justify-content: center;
      align-items: center;
      height: 100vh;
      margin: 0;
      user-select: none;
      touch-action: none;
      font-family: system-ui;
    }
  </style>
</head>

<body>
  
  <svg id="spinner-svg" width="320" height="320" viewBox="0 0 300 300">
    <polygon points="145,15 155,15 150,35" fill="#ffcc00" stroke="#333" stroke-width="1.5" />
    <circle cx="150" cy="150" r="120" fill="#222" stroke="#555" stroke-width="4" />
    <g id="spinner-group"></g>
    <circle cx="150" cy="150" r="18" fill="#111" stroke="#ffcc00" stroke-width="3" />
  </svg>
  
  <script>
    // ---- CONFIG ----
    const NUM_SLICES = 6;
    const cx = 150,
      cy = 150,
      radius = 120;
    
    // Physics parameters
    const friction = 0.995; // < 1 means it slows down gradually
    const velocityMultiplier = 2.2; // how much a swipe adds
    let angle = 0;
    let angularVelocity = 0;
    
    // Gesture tracking
    let activePointerId = null;
    let startY = null;
    let startTime = null;
    
    const spinnerGroup = document.getElementById("spinner-group");
    const svg = document.getElementById("spinner-svg");
    
    // ---- Build spinner ----
    function polar(cx, cy, r, angleDeg) {
      const rad = angleDeg * Math.PI / 180;
      return { x: cx + r * Math.cos(rad), y: cy + r * Math.sin(rad) };
    }
    
    function createSlice(startAngle, endAngle) {
      const a = polar(cx, cy, radius, startAngle);
      const b = polar(cx, cy, radius, endAngle);
      const big = endAngle - startAngle > 180 ? 1 : 0;
      
      return `M ${cx} ${cy}
          L ${a.x} ${a.y}
          A ${radius} ${radius} 0 ${big} 1 ${b.x} ${b.y}
          Z`;
    }
    
    function initSpinner() {
      spinnerGroup.innerHTML = "";
      const sliceAngle = 360 / NUM_SLICES;
      
      for (let i = 0; i < NUM_SLICES; i++) {
        const s = -90 + i * sliceAngle;
        const e = s + sliceAngle;
        let p = document.createElementNS("http://www.w3.org/2000/svg", "path");
        p.setAttribute("d", createSlice(s, e));
        p.setAttribute("fill", `hsl(${i * 60}, 70%, 40%)`);
        p.setAttribute("stroke", "#111");
        spinnerGroup.appendChild(p);
        
        const mid = (s + e) / 2;
        const pos = polar(cx, cy, radius * 0.6, mid);
        let t = document.createElementNS("http://www.w3.org/2000/svg", "text");
        t.setAttribute("x", pos.x);
        t.setAttribute("y", pos.y + 4);
        t.setAttribute("text-anchor", "middle");
        t.setAttribute("font-size", "16");
        t.setAttribute("fill", "#fff");
        t.textContent = i + 1;
        spinnerGroup.appendChild(t);
      }
    }
    
    initSpinner();
    
    // ---- Physics animation loop ----
    let lastTime = performance.now();
    
    function tick(now) {
      const dt = now - lastTime;
      lastTime = now;
      
      // Update physics
      angle += angularVelocity * dt; // v is degrees per ms
      angularVelocity *= friction; // slow down slightly
      angle %= 360;
      
      // Apply rotation
      spinnerGroup.setAttribute("transform", `rotate(${angle} ${cx} ${cy})`);
      
      requestAnimationFrame(tick);
    }
    
    requestAnimationFrame(tick);
    
    // ---- Gesture handling (adds velocity) ----
    svg.addEventListener("pointerdown", e => {
      if (activePointerId !== null) return;
      
      activePointerId = e.pointerId;
      startY = e.clientY;
      startTime = performance.now();
    });
    
    svg.addEventListener("pointerup", e => {
      if (e.pointerId !== activePointerId) return;
      
      const dy = e.clientY - startY;
      const distance = Math.abs(dy);
      const dt = performance.now() - startTime;
      
      const MIN_DIST = 20;
      if (distance >= MIN_DIST) {
        const velocity = distance / dt; // px/ms
        const boost = velocity * velocityMultiplier * (dy < 0 ? -1 : 1); // up = CCW, down = CW
        angularVelocity += boost; // â† ADD to existing velocity (the key)
      }
      
      activePointerId = null;
      startY = null;
      startTime = null;
    });
    
    svg.addEventListener("pointercancel", reset);
    svg.addEventListener("pointerleave", e => { if (e.pointerId === activePointerId) reset(); });
    
    function reset() {
      activePointerId = null;
      startY = null;
      startTime = null;
    }
  </script>
  
</body>

</html>